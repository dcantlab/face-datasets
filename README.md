# Face Datasets

## Overview

_DCANT Face Datasets_ are a collection of MATLAB pipelines for generating variations of well-known face datasets. The current collection includes:

- **KDEF-masked**: Creates masked face images from the [Karolinska Directed Emotional Faces (KDEF) dataset](https://www.kdef.se).
- **CFD-masked**: Generates masked face images from the [Chicago Face Database (CFD)](https://www.chicagofaces.org).
- **CFD-cutout**: Produces color, grayscale, and lightness-matched face-cutout images from the [CFD](https://www.chicagofaces.org).
- **sample-pipeline**: Generates masked face images from a few sample images downloaded from [Unsplash](https://unsplash.com). Below, you can compare grayscale face images with their final masked versions generated by the sample pipeline.

  ![Thumbnails of clean and masked face images](pipelines/sample-pipeline/thumbnails.jpg?raw=true)


## Setup and Usage

### Dependencies
This project relies on the following libraries:
- [MatConvNet 1.0-beta25](https://github.com/vlfeat/matconvnet)
- [OpenFace 2.2.0](https://github.com/TadasBaltrusaitis/OpenFace)
- [SHINE toolbox](https://doi.org/10.3758/BRM.42.3.671) (used only in the **CFD-cutout** pipeline)

Run the following script to download and set up these dependencies:
```
>> Step0_Libraries
```

### Pipelines

All pipelines are located in the pipelines/ directory. Follow the specific instructions below to use them.

#### KDEF-masked

To generate masked face images from KDEF:
1) Download KDEF_and_AKDEF.zip from the [KDEF website](https://kdef.se) and unpack it.
2) Copy the `KDEF/` directory, including all its contents, into `pipelines/KDEF-masked/` directory so that `KDEF/` is directly inside `KDEF-masked/`.
3) Set the MATLAB working directory to `pipelines/KDEF-masked/`.
4) Run the following scripts:
	```
	>> Step1_PrepareImages
	>> Step2_DetectLandmarks
	>> Step3_BuildDataset
	```
5) Results will be saved in the `imgs-dataset/` directory, along with dataset.xlsx and dataset.mat files.

#### CFD-masked

To generate masked face images from CFD:
1) Download cfd.zip from the [CFD website](https://www.chicagofaces.org) and unpack it.
2) Copy the `CFD/` directory, including all its contents, into `pipelines/CFD-masked/` directory so that `CFD/` is directly inside `CFD-masked/`. The `CFD/` directory can be found inside the `CFD Version 3.0/Images/` directory.
3) Set the MATLAB working directory to `pipelines/CFD-masked/`.
4) Run the following scripts:
	```
	>> Step1_PrepareImages
	>> Step2_DetectLandmarks
	>> Step3_BuildDataset
	```
5) Results will be saved in the `imgs-dataset/` directory, along with dataset.xlsx and dataset.mat.

#### CFD-cutout

To generate face-cutout images from CFD:
1) Follow steps 1â€“3 as described for **CFD-masked**.
2) Run the following scripts:
	```
	>> Step1_PrepareImages
	>> Step2_DetectLandmarks
	>> Step3_CutoutImages
	>> Step4_BuildDataset
	```
3) Results will be saved in the `imgs-dataset/` directory, along with dataset.xlsx and dataset.mat.

## Acknowledgments

### Funding

This project is supported by the National Research Foundation of Korea (NRF) grant funded by the Korea government (Ministry of Science and ICT) (No. 2022R1C1C1008628).

### Credits

Special thanks to the creators of the following tools and datasets:
- [MatConvNet](https://github.com/vlfeat/matconvnet)
- [OpenFace](https://github.com/TadasBaltrusaitis/OpenFace)
- [SHINE Toolbox](https://doi.org/10.3758/BRM.42.3.671)
- [KDEF](https://kdef.se) and [CFD](https://www.chicagofaces.org)
